# StudyFlow - План выполнения проекта

## Обзор проекта

**StudyFlow** - веб-приложение для учета домашних заданий в формате канбан-доски.
Целевая аудитория: школьники 10-17 лет и их родители.

## Стек технологий

- **Frontend**: React 18 + Vite + TypeScript
- **UI**: Tailwind CSS + shadcn/ui
- **Drag-and-drop**: dnd-kit
- **State**: Zustand
- **Backend**: Supabase (Auth + PostgreSQL + Realtime)
- **Хостинг**: Vercel
- **Push**: Firebase Cloud Messaging

## Структура проекта

```
studyflow/
├── src/
│   ├── components/
│   │   ├── ui/              # shadcn/ui компоненты
│   │   ├── board/           # Board, Column, TaskCard
│   │   ├── calendar/        # WeekView
│   │   ├── auth/            # Login, Register, ResetPassword
│   │   └── layout/          # Header, Sidebar, Navigation
│   ├── hooks/               # Кастомные хуки
│   ├── stores/              # Zustand stores
│   ├── lib/                 # Утилиты, Supabase client
│   ├── types/               # TypeScript типы
│   ├── pages/               # Страницы приложения
│   └── App.tsx
├── supabase/
│   └── migrations/          # SQL миграции
├── public/
└── package.json
```

---

## Фаза 0: Подготовка

### Локальная настройка

- [ ] **T-001** Инициализация проекта: `npm create vite@latest . -- --template react-ts`
- [ ] **T-002** Настройка Tailwind CSS v4
- [ ] **T-003** Установка shadcn/ui: `npx shadcn@latest init`
- [ ] **T-005** Базовая структура проекта, роутинг (React Router)
- [ ] **T-006** Настройка ESLint + Prettier

### Настройка Supabase (с нуля)

- [ ] **T-004a** Создать проект на https://supabase.com (Settings > API)
- [ ] **T-004b** Создать `.env.local` с VITE_SUPABASE_URL и VITE_SUPABASE_ANON_KEY
- [ ] **T-004c** Установить `@supabase/supabase-js`
- [ ] **T-004d** Создать Supabase клиент в `src/lib/supabase.ts`

---

## Волна 1: Ядро системы

### 1.1. Авторизация (FR-19, FR-21)

- [ ] **T-101** Схема БД: таблица users, RLS-политики
- [ ] **T-102** UI: страница регистрации
- [ ] **T-103** UI: страница входа
- [ ] **T-104** Интеграция Supabase Auth (email + пароль)
- [ ] **T-105** UI: страница восстановления пароля
- [ ] **T-106** Protected routes, редирект неавторизованных

### 1.2. Модель данных

- [ ] **T-111** Схема БД: таблица boards (доски)
- [ ] **T-112** Схема БД: таблица columns (колонки)
- [ ] **T-113** Схема БД: таблица tasks (задания)
- [ ] **T-114** Схема БД: таблица subjects (предметы)
- [ ] **T-115** RLS-политики для всех таблиц
- [ ] **T-116** TypeScript-типы, Supabase клиент

### 1.3. Канбан-доска (FR-01, FR-03, FR-04)

- [ ] **T-121** Установка и настройка dnd-kit
- [ ] **T-122** Компонент Board: отображение колонок
- [ ] **T-123** Компонент Column: список карточек
- [ ] **T-124** Drag-and-drop между колонками
- [ ] **T-125** Сортировка карточек внутри колонки
- [ ] **T-126** Сохранение позиций в БД после перемещения

### 1.4. Карточка задания (FR-05 - FR-09)

- [ ] **T-131** Компонент TaskCard: отображение задания
- [ ] **T-132** Модальное окно создания задания
- [ ] **T-133** Форма: предмет (select + custom input)
- [ ] **T-134** Форма: дедлайн (date + time picker)
- [ ] **T-135** Форма: приоритет (цветовые метки)
- [ ] **T-136** Модальное окно редактирования задания
- [ ] **T-137** Удаление задания с подтверждением
- [ ] **T-138** Визуальное выделение просроченных заданий

**MILESTONE M-1**: Работающая канбан-доска с CRUD

---

## Волна 2: Ключевая ценность

### 2.1. Календарь (FR-10 - FR-12)

- [ ] **T-201** Компонент WeekView: сетка на 7 дней
- [ ] **T-202** Отображение заданий в ячейках дней
- [ ] **T-203** Навигация по неделям (вперед/назад)
- [ ] **T-204** Подсветка дней с высокой нагрузкой
- [ ] **T-205** Переход к карточке по клику из календаря

### 2.2. Совместный доступ (FR-16, FR-18)

- [ ] **T-211** Схема БД: таблица board_members
- [ ] **T-212** Схема БД: таблица invites (приглашения)
- [ ] **T-213** Генерация invite-ссылки
- [ ] **T-214** UI: модалка "Поделиться доской"
- [ ] **T-215** Страница принятия приглашения
- [ ] **T-216** RLS: доступ членам доски

### 2.3. Realtime-синхронизация (FR-18, NF-02)

- [ ] **T-221** Подключение Supabase Realtime
- [ ] **T-222** Подписка на изменения tasks
- [ ] **T-223** Подписка на изменения columns
- [ ] **T-224** Оптимистичные обновления UI
- [ ] **T-225** Обработка конфликтов (last-write-wins)

### 2.4. Push-уведомления (FR-13)

- [ ] **T-231** Настройка Firebase Cloud Messaging
- [ ] **T-232** Service Worker для приема push
- [ ] **T-233** Запрос разрешения на уведомления
- [ ] **T-234** Сохранение FCM-токена в БД
- [ ] **T-235** Edge Function: отправка напоминаний
- [ ] **T-236** Cron: проверка дедлайнов каждый час

### 2.5. Адаптивный интерфейс (NF-04)

- [ ] **T-241** Mobile-first рефакторинг Board
- [ ] **T-242** Горизонтальный скролл колонок на mobile
- [ ] **T-243** Адаптивная навигация (burger menu)
- [ ] **T-244** Touch-оптимизация drag-and-drop

**MILESTONE M-2**: Полнофункциональный MVP

---

## Волна 3: Улучшения

### 3.1. Роли и права доступа (FR-17)

- [ ] **T-301** Добавление роли в board_members
- [ ] **T-302** RLS: ограничение прав наблюдателя
- [ ] **T-303** UI: выбор роли при приглашении
- [ ] **T-304** UI: скрытие кнопок редактирования для наблюдателя

### 3.2. Настройки уведомлений (FR-14, FR-15)

- [ ] **T-311** UI: страница настроек пользователя
- [ ] **T-312** Настройка времени напоминания (N часов)
- [ ] **T-313** Включение/отключение email-уведомлений
- [ ] **T-314** Edge Function: отправка email через Resend

### 3.3. OAuth (FR-20)

- [ ] **T-321** Настройка Google OAuth в Supabase
- [ ] **T-322** UI: кнопка "Войти через Google"
- [ ] **T-323** Обработка callback, связка аккаунтов

### 3.4. PWA и оффлайн (NF-05, NF-10)

- [ ] **T-331** Создание manifest.json
- [ ] **T-332** Иконки для разных платформ
- [ ] **T-333** Service Worker: кэширование статики
- [ ] **T-334** Локальное хранение данных (IndexedDB)
- [ ] **T-335** Синхронизация при восстановлении сети

### 3.5. Дополнительные улучшения (NF-09, FR-02)

- [ ] **T-341** Темная тема: CSS-переменные
- [ ] **T-342** Темная тема: переключатель в UI
- [ ] **T-343** Колонка "Повторить": настройка в UI
- [ ] **T-344** Логика автоперемещения в "Повторить"

**MILESTONE M-3**: Полный функционал MVP

---

## Фаза 4: Тестирование

- [ ] **T-401** E2E тесты: авторизация (Playwright)
- [ ] **T-402** E2E тесты: CRUD задания
- [ ] **T-403** E2E тесты: drag-and-drop
- [ ] **T-404** E2E тесты: совместный доступ
- [ ] **T-405** Тестирование на реальных устройствах
- [ ] **T-406** Исправление найденных багов

**MILESTONE M-4**: Готов к релизу

---

## Фаза 5: Запуск

- [ ] **T-501** Финальная проверка production-окружения
- [ ] **T-502** Настройка мониторинга (Sentry, analytics)
- [ ] **T-503** Документация для пользователей
- [ ] **T-504** Soft launch для тестовой группы

**MILESTONE M-5**: РЕЛИЗ MVP

---

## Критерии приемки MVP

1. Пользователь может зарегистрироваться и войти в систему
2. Пользователь может создать, редактировать и удалить задание
3. Карточки перемещаются между колонками drag-and-drop
4. Данные синхронизируются между устройствами в реальном времени
5. Пользователь может пригласить другого пользователя по ссылке
6. Приложение корректно отображается на мобильных устройствах
7. Push-уведомления приходят за день до дедлайна

---

## Верификация

После каждого milestone:
1. Запуск `npm run build` - сборка без ошибок
2. Запуск `npm run lint` - без предупреждений
3. Ручное тестирование основных сценариев в браузере
4. Проверка на мобильном устройстве (responsive)

После M-4:
1. Полный E2E прогон в Playwright
2. Тестирование на реальных устройствах (iOS Safari, Android Chrome)
3. Проверка производительности (Lighthouse)
